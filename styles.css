/* Base Reset */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
body {
	margin: 0;
	font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
	color: #0f172a;
	background: #f8fafc;
	line-height: 1.5;
}

/* Theme */
:root {
	--brand: #025940;
	--brand-600: #025940;
	--brand-700: #014c37;
	--brand-50: #e6f2ee;
}

/* Layout */
.app-header {
	padding: 1.25rem 1rem;
	text-align: center;
	background: #ffffff;
	border-bottom: 3px solid var(--brand);
}
.app-logo { height: 40px; width: auto; vertical-align: middle; margin-bottom: 0.25rem; }
.app-title { margin: 0; font-size: 1.5rem; font-weight: 700; color: var(--brand-700); }
.app-subtitle { margin: 0.25rem 0 0; color: #475569; }

.app-main { max-width: 1100px; margin: 0 auto; padding: 1rem; }

.controls {
	display: flex;
	flex-wrap: wrap;
	gap: 0.75rem 1rem;
	align-items: flex-start;
	justify-content: space-between;
	margin-bottom: 1rem;
}
.control-group { display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
.control-group.nav { flex-direction: column; align-items: flex-start; gap: 0.25rem; }
.nav-row { display: flex; gap: 0.5rem; }
.control-label { font-weight: 600; color: #334155; }
.property-title { font-weight: 700; color: var(--brand-700); display: block; }
.status { display: flex; align-items: center; gap: 0.75rem; color: #334155; }
.timer { font-variant-numeric: tabular-nums; font-weight: 700; color: var(--brand-700); }
.progress { background: #e2e8f0; padding: 0.125rem 0.5rem; border-radius: 0.375rem; }
.best { background: var(--brand-50); color: var(--brand-700); padding: 0.125rem 0.5rem; border-radius: 0.375rem; }

.board { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 0.75rem; padding: 0.75rem; }
.canvas-wrapper { position: relative; width: 100%; aspect-ratio: 16/9; border: 2px solid #bde4d4; border-radius: 0.5rem; }
.puzzle-canvas, .confetti-canvas { position: absolute; inset: 0; width: 100%; height: 100%; display: block; }
.confetti-canvas { pointer-events: none; }

/* Preview thumbnail */
.preview {
	position: absolute;
	right: 0.5rem;
	top: 0.5rem;
	width: 240px;
	max-width: 42vw;
	border: 2px solid var(--brand);
	border-radius: 0.5rem;
	background: #ffffff;
	box-shadow: 0 4px 14px rgba(0,0,0,0.08);
}
@media (max-width: 640px) {
	.preview { width: 150px; }
}

/* Buttons */
.btn {
	appearance: none;
	border: 1px solid #cbd5e1;
	background: #ffffff;
	color: #0f172a;
	padding: 0.5rem 0.75rem;
	border-radius: 0.5rem;
	cursor: pointer;
	transition: background 120ms ease, border-color 120ms ease, transform 60ms ease, color 120ms ease;
}
.btn:hover { background: #f1f5f9; }
.btn:active { transform: translateY(1px); }
.btn[aria-pressed="true"], .btn.btn-primary { background: var(--brand-600); border-color: var(--brand-700); color: #ffffff; }
.btn.btn-ghost { background: transparent; }

.btn-diff { min-width: 4.5rem; }

/* Modal */
.modal { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(15, 23, 42, 0.5); z-index: 10; }
.modal[hidden] { display: none; }
.modal-card { background: #ffffff; width: min(92vw, 520px); border-radius: 0.75rem; padding: 1rem; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
.modal-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.5rem; }
.cta { font-weight: 600; color: var(--brand-700); }
.share-fallback { display: flex; gap: 0.5rem; margin-top: 0.5rem; }
.share-link { color: var(--brand-600); text-decoration: none; }
.share-link:hover { text-decoration: underline; }

/* Footer */
.app-footer { text-align: center; padding: 1rem; color: #64748b; }

/* Accessibility helpers */
.btn:focus { outline: 3px solid #93c5fd; outline-offset: 2px; } 

/* Promo (Hard challenge) */
.promo { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(15, 23, 42, 0.55); z-index: 20; animation: promoOverlay 220ms ease-out; }
.promo[hidden] { display: none; }
.promo-card {
	background: #ffffff;
	width: min(92vw, 560px);
	border-radius: 0.9rem;
	padding: 1.25rem 1rem 1rem;
	box-shadow: 0 18px 44px rgba(0,0,0,0.18);
	border: 1px solid #e2e8f0;
	text-align: center;
	animation: promoIn 420ms cubic-bezier(.2,.7,.2,1) both;
}
.promo-badge {
	display: inline-block;
	background: var(--brand-50);
	color: var(--brand-700);
	border: 1px solid #bde4d4;
	padding: 0.25rem 0.5rem;
	border-radius: 999px;
	font-weight: 700;
	font-size: 0.8rem;
	margin-bottom: 0.5rem;
	animation: promoPulse 1.8s ease-in-out infinite;
}
.promo-actions { display: flex; gap: 0.5rem; justify-content: center; margin-top: 0.75rem; flex-wrap: wrap; }

@keyframes promoOverlay {
	from { opacity: 0; }
	to { opacity: 1; }
}
@keyframes promoIn {
	0% { opacity: 0; transform: translateY(16px) scale(.96); }
	60% { opacity: 1; transform: translateY(-2px) scale(1.01); }
	100% { opacity: 1; transform: translateY(0) scale(1); }
}
@keyframes promoPulse {
	0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(2,89,64,0.0); }
	50% { transform: scale(1.03); box-shadow: 0 0 0 6px rgba(2,89,64,0.10); }
}